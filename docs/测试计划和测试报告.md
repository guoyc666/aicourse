# 测试计划

文件状态：

- [ ] 草稿
- [x] 正式发布
- [ ] 正在修改

|            |                         |
| ---------- | ----------------------- |
| 文件标识： | Company-Project-IT-PLAN |
| 当前版本： | 1.0                     |
| 作 者：    | 郭彦晨                  |
| 完成日期： | 2025-09-25              |

[TOC]

---

## 1. 测试范围与主要内容

测试范围：本次系统测试覆盖 AI 辅助学习系统的核心功能模块与关键非功能需求，包含但不限于：

（1）**功能测试**

- 教师端：资源上传、题库管理、知识图谱查看
- 学生端：AI 问答、学习路径查看、题目练习
- 管理端：用户管理、系统监控
- 模型端：RAG 检索、知识图谱节点关联、问答质量验证

（2）**健壮性测试**

- 资源格式异常处理（损坏 PDF、空白资源）
- 提问输入异常、多轮对话异常情况
- 网络延迟、资源加载失败等场景

（3）**性能测试**

- 向量检索延迟
- 图谱加载速度
- QPS 基准压力测试（简化）

（4）**用户界面测试**

- 页面布局适配性（桌面端为主）
- 表单输入与错误提示
- 界面跳转流程一致性

（5）**安全性测试**

- 登录认证与权限控制
- API 安全（避免越权访问）
- 文件上传安全性

（6）**安装与反安装测试**

- 环境初始化脚本正确性
- 数据库首次创建与清理
- 模型文件加载与更新

## 2. 测试方法

- 黑盒测试：基于需求与用例设计覆盖功能路径，验证输入-输出行为。
- 白盒测试：针对关键后端逻辑（解析、向量化、知识图谱写入）设计单元测试，覆盖边界条件。
- 自动化测试：对核心 API 编写 pytest 自动化用例并集成到 CI；前端使用基本脚本验证页面流程。
- 性能测试：使用 JMeter 或 k6 对检索与问答接口进行负载测试（小规模并发模拟）。
- 手工验收测试：按演示用例由产品/教师进行最终验收。

## 3. 测试环境与测试辅助工具

测试环境：

| 项目         | 配置                      |
| ------------ | ------------------------- |
| 操作系统     | Windows 10 / Ubuntu 20.04 |
| 浏览器       | Chrome / Edge             |
| 后端运行环境 | Python 3.10 + FastAPI     |
| 数据库       | MySQL 8.0、Neo4j Desktop  |
| AI 运行环境  | GPU（24GB 显存）          |
| 前端环境     | Node.js 16 + Vue3         |

测试辅助工具：

| 工具            | 用途         |
| --------------- | ------------ |
| Postman         | API 接口测试 |
| PyTest          | 单元测试执行 |
| JMeter          | 性能测试     |
| Chrome DevTools | 前端调试     |
| GitHub Issues   | 缺陷管理     |
| Neo4j Browser   | 图谱验证     |
| VSCode          | 调试代码     |

## 4. 测试完成准则

基于测试用例的准则：

1. 功能性测试用例通过率达到 100%。
2. 非功能性（性能、稳定性、安全）测试用例通过率达到 ≥95%。

补充缺陷密度规则（如需更严）： 3. 在任意连续 24 小时的主要测试周期内，严重/关键缺陷密度 ≤ 1（每千行代码或每若干用例衡量），且无阻断性缺陷未关闭。

其他验收条件：

- 演示场景（指定用例）能稳定运行并通过产品/教师验收。
- 部署脚本能够在演示环境成功执行，数据可初始化与回滚。

## 5. 人员与任务表

| 人员     | 角色              | 职责/任务                                          | 时间             |
| -------- | ----------------- | -------------------------------------------------- | ---------------- |
| 郭彦晨   | 测试负责人 / 开发 | 组织测试计划，接口与模型相关测试用例，修复一线支持 | 周期内持续       |
| 张诏     | 测试工程师        | 知识图谱、导入与可视化测试、数据准备               | 周 5-8 重点参与  |
| 冯轶开   | 前端测试          | 前端交互、上传流程与 RBAC 测试                     | 周 3-6 重点参与  |
| 龙功泽   | 部署/CI           | 部署、环境搭建、性能测试支持                       | 周 2-10 重点参与 |
| 全体成员 | 验收/回归         | 参与回归测试、验收演示                             | 周 10-12         |

测试任务里程碑：

- 用例设计完成：周 2
- 单元与接口自动化覆盖：周 5
- 集成与功能测试完成：周 8-10
- 性能测试与回归：周 10
- 验收测试与报告：周 11-12

## 6. 缺陷管理与改错计划

缺陷管理流程：

1. 提交：测试人员在 GitHub Issues 提交缺陷，填写重现步骤、环境、日志与优先级。
2. 分类与分级：项目负责人/开发进行初步分级（Blocker/Critical/Major/Minor/Trivial）。
3. 指派：缺陷指派到责任开发人员并设定修复 SLA（见下）。
4. 修复：开发修复并提交 PR，关联缺陷编号。
5. 验证：测试人员验证修复并在关闭前执行回归用例。
6. 关闭：验证通过后由测试负责人关闭缺陷单。

缺陷优先级与建议 SLA：

- Blocker（阻断）：24 小时内响应并优先处理，直至解决或临时规避。
- Critical（严重）：48 小时内修复或提供补救方案。
- Major（主要）：3 个工作日内修复。
- Minor/Trivial：在下一个迭代/发布前处理。

改错策略：

- 紧急补丁：对阻断性缺陷采用 hotfix 分支策略，单独回归验证后合并主分支并发布演示镜像。
- 回归测试：所有已修复缺陷须通过对应回归测试用例；关键路径在每次集成后执行烟雾测试。

报告与记录：

- 周度测试报告包含：测试用例执行情况、已发现缺陷统计（按严重度）、阻断/未解决缺陷列表、测试进度与风险。
- 最终测试报告包含：测试总览、未解决缺陷清单、性能与稳定性结论与建议。

# 测试报告

## 概要

本次测试针对“AI 辅助的个性化学习系统（AI-COURSE）”的核心功能与关键非功能需求执行系统测试（System Testing）。测试周期为 2025-09-01 至 2025-09-25，覆盖教师端、学生端、管理端以及模型与检索相关服务。目标是验证功能实现、性能与健壮性，发现并记录缺陷以支持修复与回归验证。

## 测试对象

- 教师端资源上传与解析流程
- 知识图谱构建与可视化（Neo4j 交互）
- 向量检索（Chroma）与 RAG 问答流程
- 题库管理与练习记录
- 用户与权限（JWT/RBAC）
- 性能关键接口（检索延迟、模型调用）

## 测试环境

- 操作系统：Ubuntu 20.04（主要）、Windows 10（补充）
- 后端：Python 3.10 + FastAPI（本地容器化）
- 数据库：MySQL 8.0、Neo4j Desktop
- 向量库：Chroma（本地文件存储）
- 模型服务：vLLM/本地推理容器（GPU 24GB）
- 浏览器：Chrome 最新
- 测试工具：Postman、PyTest、JMeter、Chrome DevTools

## 测试活动与执行概况

- 编写自动化单元与接口用例（PyTest）：覆盖解析、向量化、图谱写入等关键逻辑。
- 手工功能用例执行：教师上传、知识点抽取、图谱展示、AI 问答、题库练习流程。
- 性能测试（JMeter/k6）：对检索接口与问答接口进行并发模拟（并发 50、100 两档）。
- 安全与健壮性测试：异常文件、网络波动、越权访问场景验证。

用例统计（摘要）：

- 总用例数：220
- 自动化用例：85
- 手工用例：135
- 已执行：220（100%）
- 通过：210（95.45%）
- 失败：10（4.55%）

## 主要测试结果摘要

1. 功能性

   - 资源上传与解析：大多数常见 PDF/PPT/DOCX 文件解析正常，文本抽取准确率高；对部分含复杂排版或嵌入图片的 PDF 存在段落丢失或 OCR 错误（记录为缺陷）。
   - 知识点抽取与图谱构建：基本流程可用，节点及关系创建正确；个别知识点冗余或依赖关系识别错误，需要人工校正。
   - AI 问答（RAG）：在有相关上下文时回答准确且具解释性；对跨章节或模糊问题有时返回不够精确的答案（建议增强 reranker 或调整 prompt）。
   - 题库与练习：CRUD 与答题记录功能正常；编程题沙箱在极少场景出现超时。
   - 权限控制：JWT 登录与基于角色的路由保护正常，发现一处 API 在边界角色检查中缺少严格校验（见缺陷）。

2. 性能

   - 向量检索（单请求）：平均延迟 120–350 ms（与索引大小、机器配置相关）。
   - RAG 端到端（检索 + LLM 推理）：GPU 环境下平均 0.8–1.6 s，满足设计目标（<1.5s）的大部分场景，但在复杂检索或模型冷启动场景可达 2.5s。
   - 并发压力：在并发 50 时系统稳定；并发 100 时，模型服务出现排队与部分超时，需要扩容或限流策略。

3. 稳定性与健壮性
   - 网络波动场景下，后端对外部模型/OCR API 已实现重试策略，效果良好。
   - 文件解析错误能被检测并返回合理提示；但个别解析失败未在界面展示详细错误日志（建议改进）。

## 重要缺陷清单（摘要）

- DEF-001（Critical）：跨角色权限绕过—某管理 API 在 student 角色下可返回部分用户统计数据。已修复（补丁分支），建议回归验证。
- DEF-002（Major）：复杂 PDF 中部分段落丢失或 OCR 识别错误，影响知识点抽取。建议增强 OCR 预处理与备选解析器。
- DEF-003（Major）：RAG 在高并发下模型排队导致超时（部分请求 5s+），建议引入请求队列与限流策略或扩展推理节点。
- DEF-004（Minor）：图谱可视化在大量节点（>500）时前端渲染卡顿，建议分页/按层加载。
- DEF-005（Minor）：编程题沙箱在极少场景下出现超时并未返回清晰错误码。

（完整缺陷请见 GitHub Issues 跟踪）

## 覆盖率与质量指标

- 单元测试覆盖率（后端关键模块）：约 72%
- 接口自动化通过率：96%
- 性能门槛达成：平均检索延迟与多数组合场景符合目标，但高并发需优化

## 风险与未解决问题

- 高并发情况下模型服务成为瓶颈，需在生产环境评估扩容成本或采用推理池化策略。
- 对复杂或扫描类 PDF 的解析质量仍依赖 OCR，短期内需人工纠错作为补偿手段。
- 部分边界权限检查需进一步代码审计以避免回归风险。

## 测试结论与建议

结论：系统核心功能已实现且大部分场景稳定可用，AI 问答在有充分上下文时表现良好。当前最主要的改进方向是提高复杂文档解析的鲁棒性与系统在高并发下的伸缩能力。

建议：

1. 优先修复 DEF-001、DEF-002 与 DEF-003，并在修复后执行回归测试（重点覆盖边界权限、解析用例与高并发压力）。
2. 引入或优化 reranker（cross-encoder）以提升检索质量，必要时对 prompt 进行迭代测试。
3. 在前端图谱可视化处实现按需加载或层次展示以改善渲染性能。
4. 制定模型服务的伸缩与限流策略，并在生产环境验证成本与延迟折衷。
5. 增强测试覆盖率，将关键路径单元测试覆盖率提高到 >=85%。

## 回归与发布建议

- 修复关键缺陷并完成对应回归用例，回归通过后可推进演示环境发布。
- 在演示环境发布前进行一次完整的压力测试（并发 100+）以验证扩容策略。

## 详细测试用例与缺陷记录

下表列出部分关键测试用例的执行结果、发现的缺陷（如有）、初步原因分析与负责修改的开发人员。通过用例的缺陷列用“-”表示。

| 测试用例名称                              | 测试结果       | 缺陷严重度及缺陷名称                            | 原因                                            | 修改人           |
| ----------------------------------------- | -------------- | ----------------------------------------------- | ----------------------------------------------- | ---------------- |
| 上传普通 PDF（含文本）并解析              | 通过           | -                                               | -                                               | -                |
| 上传复杂排版 PDF（含嵌入图片/多栏）并解析 | 失败           | Major：DEF-002 段落丢失 / OCR 识别错误          | OCR 预处理不足，解析器对复杂排版支持弱          | 张诏             |
| 上传 PPT 并提取文本与备注                 | 通过           | -                                               | -                                               | -                |
| 上传扫描版图片 PDF（需 OCR）              | 失败           | Major：DEF-010 扫描 PDF OCR 识别率低            | OCR 参数未做适配与二次识别流程缺失              | 张诏             |
| 上传视频并使用 Whisper 转写               | 通过           | -                                               | -                                               | -                |
| 图片（单张）文本提取（OCR）               | 通过           | -                                               | -                                               | -                |
| 知识点抽取（单章、结构清晰）              | 通过           | -                                               | -                                               | -                |
| 知识点抽取（跨章节、隐式关系）            | 失败           | Minor：DEF-011 依赖关系识别不完整               | LLM 提示词未覆盖隐式依赖范例                    | 冯轶开           |
| 构建知识图谱：创建节点与基础关系          | 通过           | -                                               | -                                               | -                |
| 图谱节点批量导入（1000 条）               | 失败           | Major：DEF-012 图谱写入超时/部分失败            | Neo4j 写入批次未做分片，事务过大                | 龙功泽           |
| 单节点删除并回滚验证                      | 通过           | -                                               | -                                               | -                |
| 图谱可视化：小规模（<100 节点）渲染       | 通过           | -                                               | -                                               | -                |
| 图谱可视化：大规模（>500 节点）渲染       | 失败           | Minor：DEF-004 前端渲染卡顿                     | 前端一次性渲染全部节点，未做按需加载            | 冯轶开           |
| 向量索引建立（文本切片入库）              | 通过           | -                                               | -                                               | -                |
| 检索延迟基线测试（单请求）                | 通过           | -                                               | -                                               | -                |
| 检索并精排（k=100 -> reranker）准确性评估 | 通过           | -                                               | -                                               | -                |
| RAG 问答：简单上下文内问题                | 通过           | -                                               | -                                               | -                |
| RAG 问答：跨章节/模糊问题                 | 失败           | Major：DEF-003 模型回答精度下降/超时            | 候选集未覆盖跨章节上下文，reranker 无法有效提升 | 郭彦晨           |
| RAG 并发 50 并发稳定性                    | 通过           | -                                               | -                                               | -                |
| RAG 并发 100 并发稳定性                   | 失败           | Critical：DEF-013 模型排队导致大量超时          | 推理节点数不足，未做请求队列/限流               | 郭彦晨           |
| 编写与提交选择题（教师端）                | 通过           | -                                               | -                                               | -                |
| 学生做选择题并记录分数                    | 通过           | -                                               | -                                               | -                |
| 编程题提交到沙箱评测（正常耗时）          | 通过           | -                                               | -                                               | -                |
| 编程题异常耗时 / 超时场景                 | 失败           | Minor：DEF-005 沙箱未返回清晰错误码             | 沙箱超时处理与错误码映射不完善                  | 冯轶开           |
| 用户注册（新用户）                        | 通过           | -                                               | -                                               | -                |
| 用户登录（正确凭证）                      | 通过           | -                                               | -                                               | -                |
| JWT 权限校验：教师角色访问教师接口        | 通过           | -                                               | -                                               | -                |
| JWT 权限校验：学生不能访问管理接口        | 失败（已修复） | Critical：DEF-001 权限绕过（管理 API 泄露统计） | 边界权限检查缺失，路由中间件未覆盖某分支        | 郭彦晨（已修复） |
| 文件上传越界检测（超大文件）              | 通过           | -                                               | -                                               | -                |
| 文件类型白名单校验                        | 通过           | -                                               | -                                               | -                |
| API 接口速率限制测试（基础）              | 通过           | -                                               | -                                               | -                |
| 日志记录完整性（关键操作）                | 通过           | -                                               | -                                               | -                |
| 部署脚本：数据库初始化与回滚              | 通过           | -                                               | -                                               | -                |
| CI 自动化用例运行（单次）                 | 通过           | -                                               | -                                               | -                |


## 附录

- 执行人：郭彦晨、张诏、冯轶开、龙功泽
- 测试周期：2025-11-20 至 2025-11-30
